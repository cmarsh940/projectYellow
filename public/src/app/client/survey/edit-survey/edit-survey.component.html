<div class="text-center">
  <h2 class="mat-title">Editing {{ survey?.name | titlecase }}</h2>
</div>

<form [formGroup]="surveyForm" (ngSubmit)="submitForm()" class="form">

  <mat-form-field>
    <mat-select placeholder="Survey Category" formControlName="category">
      <mat-option *ngFor="let category of categories" [value]="category._id">
        {{category.name}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <!-- SURVEY NAME -->
  <mat-form-field appearance="outline">
    <mat-label>Survey Name:</mat-label>
    <input matInput formControlName="name" />
  </mat-form-field>

  <!-- ARRAY OF QUESTIONS -->
  <div formArrayName="questions">
    <div *ngFor="let question of questions.controls; let i = index" [formGroupName]="i">
      <!-- QUESTION CARD -->
      <mat-card>
        <mat-card-header> 
          <h6>#{{i + 1}}</h6>
          <span class="spacer"></span>
          <mat-icon matSuffix (click)="removeQuestion(i)">clear</mat-icon>
        </mat-card-header>
        <mat-card-content>
          <!-- QUESTION TYPE -->
          <mat-form-field>
            <mat-select placeholder="Question type" formControlName="questionType">
              <mat-option *ngFor="let qType of questionTypes" [value]="qType.value">
                {{qType.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <!-- QUESTION -->
          <ng-container [ngSwitch]="surveyForm.value.questions[i]?.questionType">
            <ng-container *ngSwitchCase="'boolean'">
              <mat-form-field>
                <mat-label>Question:</mat-label>
                <input matInput formControlName="question">
              </mat-form-field>
            </ng-container>
            <ng-container *ngSwitchCase="'text'">
              <mat-form-field>
                <mat-label>Question:</mat-label>
                <input matInput formControlName="question">
              </mat-form-field>
            </ng-container>
            <ng-container *ngSwitchCase="'mutiplechoice'">
              <mat-form-field>
                <mat-label>Question:</mat-label>
                <input matInput formControlName="question">
              </mat-form-field>
            </ng-container>
            <ng-container *ngSwitchCase="'paragraph'">
              <mat-form-field>
                <mat-label>Question:</mat-label>
                <input matInput formControlName="question">
              </mat-form-field>
            </ng-container>
            <ng-container *ngSwitchCase="'smilieFaces'">
              <mat-form-field>
                <mat-label>Question:</mat-label>
                <input matInput formControlName="question">
              </mat-form-field>
            </ng-container>
            <ng-container *ngSwitchDefault>
              <b>Select Question Type</b>
            </ng-container>
          </ng-container>
        </mat-card-content>
      </mat-card>
    </div>
    <!-- Submit Button -->
    <div class="text-center" id="button-group">
      <button mat-raised-button type="button" (click)="addQuestion()" color="accent">Add Question</button>
      <button mat-stroked-button type="submit" [disabled]=!surveyForm.valid>Submit</button>
    </div>
  </div>
</form>
<div>
  <p class="text-center" [ngStyle]="{ 'color': 'red' }" *ngFor="let error of errors">{{ error }}</p>
</div>